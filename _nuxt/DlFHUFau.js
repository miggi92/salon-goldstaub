import{b4 as fe,b2 as G,r as N,d as H,aR as pe,aQ as ne,E as V,aS as ve,b5 as he,H as P,i as A,w as L,f as R,I as r,P as de,aT as j,af as O,J as ce,aa as me,b3 as ge,O as ye,b6 as le,N as xe,x as be,a9 as Ce,aX as ke,c as D,g as F,n as w,ag as Te,F as ae,V as Ie,M as Ee,e as se,a2 as Se,t as _e}from"./9K6uyTFa.js";import{c as Ke}from"./CrtF8K-A.js";import we from"./Cn7I-T_C.js";import{t as ie}from"./DXXETU1F.js";import{_ as Ae,M as Ve,a as Re}from"./hImW3tEy.js";import{u as Be}from"./RBuD0trT.js";import{i as re}from"./C_gm745W.js";import"./vsPQffrC.js";function Le(s){const n=fe("",1e3);return{search:n,handleTypeaheadSearch:(E,l)=>{n.value=n.value+E;{const u=G(),p=l.map(y=>{var S,b;return{...y,textValue:((S=y.value)==null?void 0:S.textValue)??((b=y.ref.textContent)==null?void 0:b.trim())??""}}),i=p.find(y=>y.ref===u),g=p.map(y=>y.textValue),_=$e(g,n.value,i==null?void 0:i.textValue),x=p.find(y=>y.textValue===_);return x&&x.ref.focus(),x==null?void 0:x.ref}},resetTypeahead:()=>{n.value=""}}}function Me(s,n){return s.map((e,f)=>s[(n+f)%s.length])}function $e(s,n,e){const E=n.length>1&&Array.from(n).every(g=>g===n[0])?n[0]:n,l=e?s.indexOf(e):-1;let u=Me(s,Math.max(l,0));E.length===1&&(u=u.filter(g=>g!==e));const i=u.find(g=>g.toLowerCase().startsWith(E.toLowerCase()));return i!==e?i:void 0}function U(s,n,e){const f=s.findIndex(p=>re(p,n)),E=s.findIndex(p=>re(p,e));if(f===-1||E===-1)return[];const[l,u]=[f,E].sort((p,i)=>p-i);return s.slice(l,u+1)}function q(s){return s.reduce((n,e)=>(n.push(e),e.children&&n.push(...q(e.children)),n),[])}function Ne(s,n){const e=N(),f=(l,u)=>{if(n.multiple&&Array.isArray(s.value))if(n.selectionBehavior==="replace")s.value=[l],e.value=l;else{const p=s.value.findIndex(i=>u(i));p!==-1?s.value.splice(p,1):s.value.push(l)}else n.selectionBehavior==="replace"?s.value={...l}:!Array.isArray(s.value)&&u(s.value)?s.value=void 0:s.value={...l};return s.value};function E(l,u,p,i){var y;if(!(e!=null&&e.value)||!n.multiple||!Array.isArray(s.value))return;const _=(y=p().filter(S=>S.ref.dataset.disabled!=="").find(S=>S.ref===u))==null?void 0:y.value;if(!_)return;let x=null;switch(l){case"prev":case"next":{x=U(i,e.value,_);break}case"first":{x=U(i,e.value,i==null?void 0:i[0]);break}case"last":{x=U(i,e.value,i==null?void 0:i[i.length-1]);break}}s.value=x}return{firstValue:e,onSelectItem:f,handleMultipleReplace:E}}const[De,Oe]=ve("TreeRoot"),Pe=H({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:s=>s.children},selectionBehavior:{default:"toggle"},multiple:{type:Boolean},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(s,{emit:n}){const e=s,f=n,{items:E,multiple:l,disabled:u,propagateSelect:p,dir:i}=pe(e),{handleTypeaheadSearch:g}=Le(),_=Be(i),x=N(),y=N(!1),S=he(),b=ne(e,"modelValue",f,{defaultValue:e.defaultValue??(l.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),o=ne(e,"expanded",f,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:h,handleMultipleReplace:t}=Ne(b,e),d=V(()=>l.value&&Array.isArray(b.value)?b.value.map(a=>e.getKey(a)):[e.getKey(b.value??{})]);function c(a,v=1,T){return a.reduce((I,K,B)=>{const M=e.getKey(K),$=e.getChildren(K),W=o.value.includes(M),z={_id:M,value:K,index:B,level:v,parentItem:T,hasChildren:!!$,bind:{value:K,level:v,"aria-setsize":a.length,"aria-posinset":B+1}};return I.push(z),$&&W&&I.push(...c($,v+1,K)),I},[])}const m=V(()=>{const a=e.items;return o.value.map(v=>v),c(a??[])});function C(a){var v;if(y.value)S.trigger(a);else{const T=((v=x.value)==null?void 0:v.getItems())??[];g(a.key,T)}}function k(a){if(y.value)return;const v=Ve[a.key];me(()=>{var T;t(v,G(),(T=x.value)==null?void 0:T.getItems,m.value.map(I=>I.value))})}return Oe({modelValue:b,selectedKeys:d,onSelect:a=>{var I;const v=K=>e.getKey(K??{})===e.getKey(a),T=e.multiple&&Array.isArray(b.value)?((I=b.value)==null?void 0:I.findIndex(v))!==-1:void 0;if(h(a,v),e.propagateSelect&&e.multiple&&Array.isArray(b.value)){const K=q(e.getChildren(a)??[]);T?b.value=[...b.value].filter(B=>!K.some(M=>e.getKey(B??{})===e.getKey(M))):b.value=[...b.value,...K]}},expanded:o,onToggle(a){if(!(a?e.getChildren(a):void 0))return;const T=e.getKey(a)??a;o.value.includes(T)?o.value=o.value.filter(I=>I!==T):o.value.push(T)},getKey:e.getKey,getChildren:e.getChildren,items:E,expandedItems:m,disabled:u,multiple:l,dir:_,propagateSelect:p,isVirtual:y,virtualKeydownHook:S,handleMultipleReplace:t}),(a,v)=>(A(),P(r(Ae),{ref_key:"rovingFocusGroupRef",ref:x,"as-child":"",orientation:"vertical",dir:r(_)},{default:L(()=>[R(r(de),{role:"tree",as:a.as,"as-child":a.asChild,"aria-multiselectable":r(l)?!0:void 0,onKeydown:[C,j(O(k,["shift"]),["up","down"])]},{default:L(()=>[ce(a.$slots,"default",{flattenItems:m.value,modelValue:r(b),expanded:r(o)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),We="tree.select",ze="tree.toggle",Fe=H({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(s,{expose:n,emit:e}){const f=s,E=e,l=De(),{getItems:u}=ge(),p=V(()=>!!l.getChildren(f.value)),i=V(()=>{const t=l.getKey(f.value);return l.expanded.value.includes(t)}),g=V(()=>{const t=l.getKey(f.value);return l.selectedKeys.value.includes(t)}),_=V(()=>{if(l.propagateSelect.value&&g.value&&p.value&&Array.isArray(l.modelValue.value))return!q(l.getChildren(f.value)||[]).every(d=>l.modelValue.value.find(c=>l.getKey(c)===l.getKey(d)))});function x(t){if(p.value)if(i.value){const d=u().map(a=>a.ref),c=G(),m=d.indexOf(c),k=[...d].slice(m).find(a=>Number(a.getAttribute("data-indent"))===f.level+1);k&&k.focus()}else h(t)}function y(t){if(i.value)h(t);else{const d=u().map(a=>a.ref),c=G(),m=d.indexOf(c),k=[...d].slice(0,m).reverse().find(a=>Number(a.getAttribute("data-indent"))===f.level-1);k&&k.focus()}}async function S(t){E("select",t),!(t!=null&&t.defaultPrevented)&&l.onSelect(f.value)}async function b(t){E("toggle",t),!(t!=null&&t.defaultPrevented)&&l.onToggle(f.value)}async function o(t){if(!t)return;const d={originalEvent:t,value:f.value,isExpanded:i.value,isSelected:g.value};le(We,S,d)}async function h(t){if(!t)return;const d={originalEvent:t,value:f.value,isExpanded:i.value,isSelected:g.value};le(ze,b,d)}return n({isExpanded:i,isSelected:g,isIndeterminate:_,handleToggle:()=>l.onToggle(f.value),handleSelect:()=>l.onSelect(f.value)}),(t,d)=>(A(),P(r(Re),{"as-child":"",value:t.value,"allow-shift-key":""},{default:L(()=>[R(r(de),ye(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":g.value,"aria-expanded":p.value?i.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":g.value?"":void 0,"data-expanded":i.value?"":void 0,onKeydown:[j(O(o,["self","prevent"]),["enter","space"]),d[0]||(d[0]=j(O(c=>r(l).dir.value==="ltr"?x(c):y(c),["prevent"]),["right"])),d[1]||(d[1]=j(O(c=>r(l).dir.value==="ltr"?y(c):x(c),["prevent"]),["left"]))],onClick:d[2]||(d[2]=O(c=>{o(c),h(c)},["stop"]))}),{default:L(()=>[ce(t.$slots,"default",{isExpanded:i.value,isSelected:g.value,isIndeterminate:_.value,handleSelect:()=>r(l).onSelect(t.value),handleToggle:()=>r(l).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),je={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-(--ui-border-muted) rounded-[calc(var(--ui-radius)*1.5)]",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-(--ui-border-muted) overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-(--ui-border)",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-(--ui-text-highlighted) before:bg-(--ui-bg-elevated)"},false:{link:["hover:text-(--ui-text-highlighted) hover:before:bg-(--ui-bg-elevated)/50","transition-colors before:transition-colors"]}}}},Ge=Ee;var oe,ue;const Ue=ie({extend:ie(je),...((ue=(oe=Ge.uiPro)==null?void 0:oe.prose)==null?void 0:ue.codeTree)||{}}),He=H({__name:"CodeTree",props:{defaultValue:{},class:{},ui:{}},setup(s){const n=s,e=xe(),f=be(),[E,l]=Ke(),u=Ue(),p=N(n.defaultValue?{path:n.defaultValue}:void 0),i=N(),g=N(1),_=V(()=>{var o,h;return g.value,((h=(o=e.default)==null?void 0:o.call(e))==null?void 0:h.flatMap(S).filter(Boolean))||[]}),x=V(()=>y(_.value));function y(o){const h=new Map,t=[];o.forEach(c=>{const m=c.label.split("/");let C="";m.forEach((k,a)=>{var v,T;if(C=C?`${C}/${k}`:k,!h.has(C)){const I={label:k,path:C,...a<m.length-1&&{children:[]}};h.set(C,I),a===0?t.push(I):(T=(v=h.get(m.slice(0,a).join("/")))==null?void 0:v.children)==null||T.push(I)}})});const d=c=>c.sort((m,C)=>!!m.children==!!C.children?m.label.localeCompare(C.label):C.children?1:-1).map(m=>({...m,children:m.children&&d(m.children)}));return d(t)}function S(o,h){var t,d,c,m;return typeof o.type=="symbol"?(t=o.children)==null?void 0:t.map(S):{label:((d=o.props)==null?void 0:d.filename)||((c=o.props)==null?void 0:c.label)||`${h}`,icon:(m=o.props)==null?void 0:m.icon,component:o}}const b=V(()=>{var t;const o=(t=p.value)==null?void 0:t.path;if(!o)return[];const h=o.split("/");return h.map((d,c)=>h.slice(0,c+1).join("/"))});return Ce(p,o=>{const h=_.value.find(t=>(o==null?void 0:o.path)===t.label);h!=null&&h.component&&(i.value=h)},{immediate:!0}),ke(()=>g.value++),(o,h)=>{var d,c,m,C;const t=Se;return A(),D(ae,null,[R(r(E),null,{default:L(({items:k,level:a})=>[(A(!0),D(ae,null,Ie(k,(v,T)=>{var I,K;return A(),D("li",{key:`${a}-${T}`,class:w(a>0?r(u).itemWithChildren({class:(I=n.ui)==null?void 0:I.itemWithChildren}):r(u).item({class:(K=n.ui)==null?void 0:K.item}))},[R(r(Fe),{"as-child":"",level:a,value:v},{default:L(({isExpanded:B,isSelected:M})=>{var $,W,z,J,Q,X,Y,Z,ee,te;return[F("button",{class:w(r(u).link({class:($=n.ui)==null?void 0:$.link,active:M}))},[(W=v.children)!=null&&W.length?(A(),P(t,{key:0,name:B?r(f).ui.icons.folderOpen:r(f).ui.icons.folder,class:w(r(u).linkLeadingIcon({class:(z=n.ui)==null?void 0:z.linkLeadingIcon}))},null,8,["name","class"])):(A(),P(we,{key:1,filename:v.label,class:w(r(u).linkLeadingIcon({class:(J=n.ui)==null?void 0:J.linkLeadingIcon}))},null,8,["filename","class"])),F("span",{class:w(r(u).linkLabel({class:(Q=n.ui)==null?void 0:Q.linkLabel}))},_e(v.label),3),(X=v.children)!=null&&X.length?(A(),D("span",{key:2,class:w(r(u).linkTrailing({class:(Y=n.ui)==null?void 0:Y.linkTrailing}))},[R(t,{name:r(f).ui.icons.chevronDown,class:w(r(u).linkTrailingIcon({class:(Z=n.ui)==null?void 0:Z.linkTrailingIcon}))},null,8,["name","class"])],2)):se("",!0)],2),(ee=v.children)!=null&&ee.length&&B?(A(),D("ul",{key:0,class:w(r(u).listWithChildren({class:(te=n.ui)==null?void 0:te.listWithChildren}))},[R(r(l),{items:v.children,level:a+1},null,8,["items","level"])],2)):se("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),F("div",{class:w(r(u).root({class:[n.class,(d=n.ui)==null?void 0:d.root]}))},[R(r(Pe),{modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=k=>p.value=k),class:w(r(u).list({class:(c=n.ui)==null?void 0:c.list})),items:x.value,"get-key":k=>k.path,"default-expanded":b.value},{default:L(()=>[R(r(l),{items:x.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),F("div",{class:w(r(u).content({class:(m=n.ui)==null?void 0:m.content}))},[(A(),P(Te((C=i.value)==null?void 0:C.component)))],2)],2)],64)}}}),nt=Object.assign(He,{__name:"ProseCodeTree"});export{nt as default};
