import{b6 as fe,b4 as G,aR as le,r as N,d as H,aT as pe,aS as ne,G as V,aU as ve,b7 as he,I as P,i as A,w as L,f as R,J as r,P as de,aV as j,ai as O,K as ce,ad as me,b5 as ge,Q as ye,b8 as ae,O as xe,x as be,ac as Ce,aZ as ke,c as D,g as F,n as w,aj as Te,F as se,W as Ie,N as Se,e as ie,a5 as Ee,t as Ke}from"./DbPeIGNn.js";import{c as _e}from"./B4AWSsha.js";import we from"./bg5r2tzl.js";import{t as re}from"./CKvRpjBC.js";import{_ as Ae,M as Ve,a as Re}from"./CROgYSQP.js";import{u as Be}from"./CTCQ6__4.js";import"./BrNfvGy8.js";function Le(s){const l=fe("",1e3);return{search:l,handleTypeaheadSearch:(S,n)=>{l.value=l.value+S;{const u=G(),p=n.map(y=>{var E,b;return{...y,textValue:((E=y.value)==null?void 0:E.textValue)??((b=y.ref.textContent)==null?void 0:b.trim())??""}}),i=p.find(y=>y.ref===u),g=p.map(y=>y.textValue),K=Me(g,l.value,i==null?void 0:i.textValue),x=p.find(y=>y.textValue===K);return x&&x.ref.focus(),x==null?void 0:x.ref}},resetTypeahead:()=>{l.value=""}}}function $e(s,l){return s.map((e,f)=>s[(l+f)%s.length])}function Me(s,l,e){const S=l.length>1&&Array.from(l).every(g=>g===l[0])?l[0]:l,n=e?s.indexOf(e):-1;let u=$e(s,Math.max(n,0));S.length===1&&(u=u.filter(g=>g!==e));const i=u.find(g=>g.toLowerCase().startsWith(S.toLowerCase()));return i!==e?i:void 0}function U(s,l,e){const f=s.findIndex(p=>le(p,l)),S=s.findIndex(p=>le(p,e));if(f===-1||S===-1)return[];const[n,u]=[f,S].sort((p,i)=>p-i);return s.slice(n,u+1)}function q(s){return s.reduce((l,e)=>(l.push(e),e.children&&l.push(...q(e.children)),l),[])}function Ne(s,l){const e=N(),f=(n,u)=>{if(l.multiple&&Array.isArray(s.value))if(l.selectionBehavior==="replace")s.value=[n],e.value=n;else{const p=s.value.findIndex(i=>u(i));p!==-1?s.value.splice(p,1):s.value.push(n)}else l.selectionBehavior==="replace"?s.value={...n}:!Array.isArray(s.value)&&u(s.value)?s.value=void 0:s.value={...n};return s.value};function S(n,u,p,i){var y;if(!(e!=null&&e.value)||!l.multiple||!Array.isArray(s.value))return;const K=(y=p().filter(E=>E.ref.dataset.disabled!=="").find(E=>E.ref===u))==null?void 0:y.value;if(!K)return;let x=null;switch(n){case"prev":case"next":{x=U(i,e.value,K);break}case"first":{x=U(i,e.value,i==null?void 0:i[0]);break}case"last":{x=U(i,e.value,i==null?void 0:i[i.length-1]);break}}s.value=x}return{firstValue:e,onSelectItem:f,handleMultipleReplace:S}}const[De,Oe]=ve("TreeRoot"),Pe=H({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:s=>s.children},selectionBehavior:{default:"toggle"},multiple:{type:Boolean},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(s,{emit:l}){const e=s,f=l,{items:S,multiple:n,disabled:u,propagateSelect:p,dir:i}=pe(e),{handleTypeaheadSearch:g}=Le(),K=Be(i),x=N(),y=N(!1),E=he(),b=ne(e,"modelValue",f,{defaultValue:e.defaultValue??(n.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),o=ne(e,"expanded",f,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:h,handleMultipleReplace:t}=Ne(b,e),d=V(()=>n.value&&Array.isArray(b.value)?b.value.map(a=>e.getKey(a)):[e.getKey(b.value??{})]);function c(a,v=1,T){return a.reduce((I,_,B)=>{const $=e.getKey(_),M=e.getChildren(_),W=o.value.includes($),z={_id:$,value:_,index:B,level:v,parentItem:T,hasChildren:!!M,bind:{value:_,level:v,"aria-setsize":a.length,"aria-posinset":B+1}};return I.push(z),M&&W&&I.push(...c(M,v+1,_)),I},[])}const m=V(()=>{const a=e.items;return o.value.map(v=>v),c(a??[])});function C(a){var v;if(y.value)E.trigger(a);else{const T=((v=x.value)==null?void 0:v.getItems())??[];g(a.key,T)}}function k(a){if(y.value)return;const v=Ve[a.key];me(()=>{var T;t(v,G(),(T=x.value)==null?void 0:T.getItems,m.value.map(I=>I.value))})}return Oe({modelValue:b,selectedKeys:d,onSelect:a=>{var I;const v=_=>e.getKey(_??{})===e.getKey(a),T=e.multiple&&Array.isArray(b.value)?((I=b.value)==null?void 0:I.findIndex(v))!==-1:void 0;if(h(a,v),e.propagateSelect&&e.multiple&&Array.isArray(b.value)){const _=q(e.getChildren(a)??[]);T?b.value=[...b.value].filter(B=>!_.some($=>e.getKey(B??{})===e.getKey($))):b.value=[...b.value,..._]}},expanded:o,onToggle(a){if(!(a?e.getChildren(a):void 0))return;const T=e.getKey(a)??a;o.value.includes(T)?o.value=o.value.filter(I=>I!==T):o.value.push(T)},getKey:e.getKey,getChildren:e.getChildren,items:S,expandedItems:m,disabled:u,multiple:n,dir:K,propagateSelect:p,isVirtual:y,virtualKeydownHook:E,handleMultipleReplace:t}),(a,v)=>(A(),P(r(Ae),{ref_key:"rovingFocusGroupRef",ref:x,"as-child":"",orientation:"vertical",dir:r(K)},{default:L(()=>[R(r(de),{role:"tree",as:a.as,"as-child":a.asChild,"aria-multiselectable":r(n)?!0:void 0,onKeydown:[C,j(O(k,["shift"]),["up","down"])]},{default:L(()=>[ce(a.$slots,"default",{flattenItems:m.value,modelValue:r(b),expanded:r(o)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),We="tree.select",ze="tree.toggle",Fe=H({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(s,{expose:l,emit:e}){const f=s,S=e,n=De(),{getItems:u}=ge(),p=V(()=>!!n.getChildren(f.value)),i=V(()=>{const t=n.getKey(f.value);return n.expanded.value.includes(t)}),g=V(()=>{const t=n.getKey(f.value);return n.selectedKeys.value.includes(t)}),K=V(()=>{if(n.propagateSelect.value&&g.value&&p.value&&Array.isArray(n.modelValue.value))return!q(n.getChildren(f.value)||[]).every(d=>n.modelValue.value.find(c=>n.getKey(c)===n.getKey(d)))});function x(t){if(p.value)if(i.value){const d=u().map(a=>a.ref),c=G(),m=d.indexOf(c),k=[...d].slice(m).find(a=>Number(a.getAttribute("data-indent"))===f.level+1);k&&k.focus()}else h(t)}function y(t){if(i.value)h(t);else{const d=u().map(a=>a.ref),c=G(),m=d.indexOf(c),k=[...d].slice(0,m).reverse().find(a=>Number(a.getAttribute("data-indent"))===f.level-1);k&&k.focus()}}async function E(t){S("select",t),!(t!=null&&t.defaultPrevented)&&n.onSelect(f.value)}async function b(t){S("toggle",t),!(t!=null&&t.defaultPrevented)&&n.onToggle(f.value)}async function o(t){if(!t)return;const d={originalEvent:t,value:f.value,isExpanded:i.value,isSelected:g.value};ae(We,E,d)}async function h(t){if(!t)return;const d={originalEvent:t,value:f.value,isExpanded:i.value,isSelected:g.value};ae(ze,b,d)}return l({isExpanded:i,isSelected:g,isIndeterminate:K,handleToggle:()=>n.onToggle(f.value),handleSelect:()=>n.onSelect(f.value)}),(t,d)=>(A(),P(r(Re),{"as-child":"",value:t.value,"allow-shift-key":""},{default:L(()=>[R(r(de),ye(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":g.value,"aria-expanded":p.value?i.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":g.value?"":void 0,"data-expanded":i.value?"":void 0,onKeydown:[j(O(o,["self","prevent"]),["enter","space"]),d[0]||(d[0]=j(O(c=>r(n).dir.value==="ltr"?x(c):y(c),["prevent"]),["right"])),d[1]||(d[1]=j(O(c=>r(n).dir.value==="ltr"?y(c):x(c),["prevent"]),["left"]))],onClick:d[2]||(d[2]=O(c=>{o(c),h(c)},["stop"]))}),{default:L(()=>[ce(t.$slots,"default",{isExpanded:i.value,isSelected:g.value,isIndeterminate:K.value,handleSelect:()=>r(n).onSelect(t.value),handleToggle:()=>r(n).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),je={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-(--ui-border-muted) rounded-[calc(var(--ui-radius)*1.5)]",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-(--ui-border-muted) overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-(--ui-border)",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-(--ui-text-highlighted) before:bg-(--ui-bg-elevated)"},false:{link:["hover:text-(--ui-text-highlighted) hover:before:bg-(--ui-bg-elevated)/50","transition-colors before:transition-colors"]}}}},Ge=Se;var oe,ue;const Ue=re({extend:re(je),...((ue=(oe=Ge.uiPro)==null?void 0:oe.prose)==null?void 0:ue.codeTree)||{}}),He=H({__name:"CodeTree",props:{defaultValue:{},class:{},ui:{}},setup(s){const l=s,e=xe(),f=be(),[S,n]=_e(),u=Ue(),p=N(l.defaultValue?{path:l.defaultValue}:void 0),i=N(),g=N(1),K=V(()=>{var o,h;return g.value,((h=(o=e.default)==null?void 0:o.call(e))==null?void 0:h.flatMap(E).filter(Boolean))||[]}),x=V(()=>y(K.value));function y(o){const h=new Map,t=[];o.forEach(c=>{const m=c.label.split("/");let C="";m.forEach((k,a)=>{var v,T;if(C=C?`${C}/${k}`:k,!h.has(C)){const I={label:k,path:C,...a<m.length-1&&{children:[]}};h.set(C,I),a===0?t.push(I):(T=(v=h.get(m.slice(0,a).join("/")))==null?void 0:v.children)==null||T.push(I)}})});const d=c=>c.sort((m,C)=>!!m.children==!!C.children?m.label.localeCompare(C.label):C.children?1:-1).map(m=>({...m,children:m.children&&d(m.children)}));return d(t)}function E(o,h){var t,d,c,m;return typeof o.type=="symbol"?(t=o.children)==null?void 0:t.map(E):{label:((d=o.props)==null?void 0:d.filename)||((c=o.props)==null?void 0:c.label)||`${h}`,icon:(m=o.props)==null?void 0:m.icon,component:o}}const b=V(()=>{var t;const o=(t=p.value)==null?void 0:t.path;if(!o)return[];const h=o.split("/");return h.map((d,c)=>h.slice(0,c+1).join("/"))});return Ce(p,o=>{const h=K.value.find(t=>(o==null?void 0:o.path)===t.label);h!=null&&h.component&&(i.value=h)},{immediate:!0}),ke(()=>g.value++),(o,h)=>{var d,c,m,C;const t=Ee;return A(),D(se,null,[R(r(S),null,{default:L(({items:k,level:a})=>[(A(!0),D(se,null,Ie(k,(v,T)=>{var I,_;return A(),D("li",{key:`${a}-${T}`,class:w(a>0?r(u).itemWithChildren({class:(I=l.ui)==null?void 0:I.itemWithChildren}):r(u).item({class:(_=l.ui)==null?void 0:_.item}))},[R(r(Fe),{"as-child":"",level:a,value:v},{default:L(({isExpanded:B,isSelected:$})=>{var M,W,z,J,Q,Y,Z,X,ee,te;return[F("button",{class:w(r(u).link({class:(M=l.ui)==null?void 0:M.link,active:$}))},[(W=v.children)!=null&&W.length?(A(),P(t,{key:0,name:B?r(f).ui.icons.folderOpen:r(f).ui.icons.folder,class:w(r(u).linkLeadingIcon({class:(z=l.ui)==null?void 0:z.linkLeadingIcon}))},null,8,["name","class"])):(A(),P(we,{key:1,filename:v.label,class:w(r(u).linkLeadingIcon({class:(J=l.ui)==null?void 0:J.linkLeadingIcon}))},null,8,["filename","class"])),F("span",{class:w(r(u).linkLabel({class:(Q=l.ui)==null?void 0:Q.linkLabel}))},Ke(v.label),3),(Y=v.children)!=null&&Y.length?(A(),D("span",{key:2,class:w(r(u).linkTrailing({class:(Z=l.ui)==null?void 0:Z.linkTrailing}))},[R(t,{name:r(f).ui.icons.chevronDown,class:w(r(u).linkTrailingIcon({class:(X=l.ui)==null?void 0:X.linkTrailingIcon}))},null,8,["name","class"])],2)):ie("",!0)],2),(ee=v.children)!=null&&ee.length&&B?(A(),D("ul",{key:0,class:w(r(u).listWithChildren({class:(te=l.ui)==null?void 0:te.listWithChildren}))},[R(r(n),{items:v.children,level:a+1},null,8,["items","level"])],2)):ie("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),F("div",{class:w(r(u).root({class:[l.class,(d=l.ui)==null?void 0:d.root]}))},[R(r(Pe),{modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=k=>p.value=k),class:w(r(u).list({class:(c=l.ui)==null?void 0:c.list})),items:x.value,"get-key":k=>k.path,"default-expanded":b.value},{default:L(()=>[R(r(n),{items:x.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),F("div",{class:w(r(u).content({class:(m=l.ui)==null?void 0:m.content}))},[(A(),P(Te((C=i.value)==null?void 0:C.component)))],2)],2)],64)}}}),tt=Object.assign(He,{__name:"ProseCodeTree"});export{tt as default};
