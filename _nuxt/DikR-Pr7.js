import{c as ce}from"./1AtZds94.js";import{d1 as fe,c$ as H,aY as ee,r as O,L as ie,a$ as ve,aZ as te,C as B,a_ as pe,d2 as he,D as z,h as V,w as P,e as $,K as k,P as oe,b0 as G,af as W,E as ue,a9 as me,d0 as ge,H as de,d3 as le,B as ye,x as be,a8 as xe,aW as Ce,c as N,f as q,F as ae,Q as ke,n as _,ag as Te,d as ne,a1 as re,t as Ke}from"./nEK7AWuc.js";import{t as se}from"./BSVobMQx.js";import Se from"./Dq8FDmQV.js";import{_ as Ie,M as Ae,a as Ee}from"./BJK-gdqN.js";import{u as we}from"./C0IsbSZ7.js";import"./B0JdctL9.js";function _e(s){const n=fe("",1e3);return{search:n,handleTypeaheadSearch:(K,l)=>{n.value=n.value+K;{const f=H(),p=l.map(y=>{var I,R;return{...y,textValue:((I=y.value)==null?void 0:I.textValue)??((R=y.ref.textContent)==null?void 0:R.trim())??""}}),i=p.find(y=>y.ref===f),g=p.map(y=>y.textValue),E=Be(g,n.value,i==null?void 0:i.textValue),T=p.find(y=>y.textValue===E);return T&&T.ref.focus(),T==null?void 0:T.ref}},resetTypeahead:()=>{n.value=""}}}function Ve(s,n){return s.map((e,c)=>s[(n+c)%s.length])}function Be(s,n,e){const K=n.length>1&&Array.from(n).every(g=>g===n[0])?n[0]:n,l=e?s.indexOf(e):-1;let f=Ve(s,Math.max(l,0));K.length===1&&(f=f.filter(g=>g!==e));const i=f.find(g=>g.toLowerCase().startsWith(K.toLowerCase()));return i!==e?i:void 0}function Y(s,n,e){const c=s.findIndex(p=>ee(p,n)),K=s.findIndex(p=>ee(p,e));if(c===-1||K===-1)return[];const[l,f]=[c,K].sort((p,i)=>p-i);return s.slice(l,f+1)}function U(s){return s.reduce((n,e)=>(n.push(e),e.children&&n.push(...U(e.children)),n),[])}function Re(s,n){const e=O(),c=(l,f)=>{if(n.multiple&&Array.isArray(s.value))if(n.selectionBehavior==="replace")s.value=[l],e.value=l;else{const p=s.value.findIndex(i=>f(i));p!==-1?s.value=s.value.filter((i,g)=>g!==p):s.value=[...s.value,l]}else n.selectionBehavior==="replace"?s.value={...l}:!Array.isArray(s.value)&&f(s.value)?s.value=void 0:s.value={...l};return s.value};function K(l,f,p,i){var y;if(!(e!=null&&e.value)||!n.multiple||!Array.isArray(s.value))return;const E=(y=p().filter(I=>I.ref.dataset.disabled!=="").find(I=>I.ref===f))==null?void 0:y.value;if(!E)return;let T=null;switch(l){case"prev":case"next":{T=Y(i,e.value,E);break}case"first":{T=Y(i,e.value,i==null?void 0:i[0]);break}case"last":{T=Y(i,e.value,i==null?void 0:i[i.length-1]);break}}s.value=T}return{firstValue:e,onSelectItem:c,handleMultipleReplace:K}}const[$e,Le]=pe("TreeRoot"),Me=ie({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:s=>s.children},selectionBehavior:{default:"toggle"},multiple:{},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},bubbleSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(s,{emit:n}){const e=s,c=n,{items:K,multiple:l,disabled:f,propagateSelect:p,dir:i,bubbleSelect:g}=ve(e),{handleTypeaheadSearch:E}=_e(),T=we(i),y=O(),I=O(!1),R=he(),a=te(e,"modelValue",c,{defaultValue:e.defaultValue??(l.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),o=te(e,"expanded",c,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:t,handleMultipleReplace:r}=Re(a,e),d=B(()=>l.value&&Array.isArray(a.value)?a.value.map(u=>e.getKey(u)):[e.getKey(a.value??{})]);function h(u,m=1,x){return u.reduce((A,C,w)=>{const M=e.getKey(C),D=e.getChildren(C),F=o.value.includes(M),j={_id:M,value:C,index:w,level:m,parentItem:x,hasChildren:!!D,bind:{value:C,level:m,"aria-setsize":u.length,"aria-posinset":w+1}};return A.push(j),D&&F&&A.push(...h(D,m+1,C)),A},[])}const v=B(()=>{const u=e.items;return o.value.map(m=>m),h(u??[])});function S(u){var m;if(I.value)R.trigger(u);else{const x=((m=y.value)==null?void 0:m.getItems())??[];E(u.key,x)}}function b(u){if(I.value)return;const m=Ae[u.key];me(()=>{var x;r(m,H(),(x=y.value)==null?void 0:x.getItems,v.value.map(A=>A.value))})}function L(u){var m;if(u.parentItem!=null&&Array.isArray(a.value)&&e.multiple){const x=v.value.find(A=>u.parentItem!=null&&e.getKey(A.value)===e.getKey(u.parentItem));x!=null&&(((m=e.getChildren(x.value))==null?void 0:m.every(C=>a.value.find(w=>e.getKey(w)===e.getKey(C))))?a.value=[...a.value,x.value]:a.value=a.value.filter(C=>e.getKey(C)!==e.getKey(x.value)),L(x))}}return Le({modelValue:a,selectedKeys:d,onSelect:u=>{var A;const m=C=>e.getKey(C??{})===e.getKey(u),x=e.multiple&&Array.isArray(a.value)?((A=a.value)==null?void 0:A.findIndex(m))!==-1:void 0;if(t(u,m),e.bubbleSelect&&e.multiple&&Array.isArray(a.value)){const C=v.value.find(w=>e.getKey(w.value)===e.getKey(u));C!=null&&L(C)}if(e.propagateSelect&&e.multiple&&Array.isArray(a.value)){const C=U(e.getChildren(u)??[]);x?a.value=[...a.value].filter(w=>!C.some(M=>e.getKey(w??{})===e.getKey(M))):a.value=[...a.value,...C]}},expanded:o,onToggle(u){if(!(u?e.getChildren(u):void 0))return;const x=e.getKey(u)??u;o.value.includes(x)?o.value=o.value.filter(A=>A!==x):o.value.push(x)},getKey:e.getKey,getChildren:e.getChildren,items:K,expandedItems:v,disabled:f,multiple:l,dir:T,propagateSelect:p,bubbleSelect:g,isVirtual:I,virtualKeydownHook:R,handleMultipleReplace:r}),(u,m)=>(V(),z(k(Ie),{ref_key:"rovingFocusGroupRef",ref:y,"as-child":"",orientation:"vertical",dir:k(T)},{default:P(()=>[$(k(oe),{role:"tree",as:u.as,"as-child":u.asChild,"aria-multiselectable":k(l)?!0:void 0,onKeydown:[S,G(W(b,["shift"]),["up","down"])]},{default:P(()=>[ue(u.$slots,"default",{flattenItems:v.value,modelValue:k(a),expanded:k(o)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),Pe="tree.select",De="tree.toggle",Oe=ie({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(s,{expose:n,emit:e}){const c=s,K=e,l=$e(),{getItems:f}=ge(),p=B(()=>!!l.getChildren(c.value)),i=B(()=>{const t=l.getKey(c.value);return l.expanded.value.includes(t)}),g=B(()=>{const t=l.getKey(c.value);return l.selectedKeys.value.includes(t)}),E=B(()=>{if(l.bubbleSelect.value&&p.value&&Array.isArray(l.modelValue.value)){const t=U(l.getChildren(c.value)||[]);return t.some(r=>l.modelValue.value.find(d=>l.getKey(d)===l.getKey(r)))&&!t.every(r=>l.modelValue.value.find(d=>l.getKey(d)===l.getKey(r)))}else return l.propagateSelect.value&&g.value&&p.value&&Array.isArray(l.modelValue.value)?!U(l.getChildren(c.value)||[]).every(r=>l.modelValue.value.find(d=>l.getKey(d)===l.getKey(r))):void 0});function T(t){if(p.value)if(i.value){const r=f().map(b=>b.ref),d=H(),h=r.indexOf(d),S=[...r].slice(h).find(b=>Number(b.getAttribute("data-indent"))===c.level+1);S&&S.focus()}else o(t)}function y(t){if(i.value)o(t);else{const r=f().map(b=>b.ref),d=H(),h=r.indexOf(d),S=[...r].slice(0,h).reverse().find(b=>Number(b.getAttribute("data-indent"))===c.level-1);S&&S.focus()}}async function I(t){K("select",t),!(t!=null&&t.defaultPrevented)&&l.onSelect(c.value)}async function R(t){K("toggle",t),!(t!=null&&t.defaultPrevented)&&l.onToggle(c.value)}async function a(t){if(!t)return;const r={originalEvent:t,value:c.value,isExpanded:i.value,isSelected:g.value};le(Pe,I,r)}async function o(t){if(!t)return;const r={originalEvent:t,value:c.value,isExpanded:i.value,isSelected:g.value};le(De,R,r)}return n({isExpanded:i,isSelected:g,isIndeterminate:E,handleToggle:()=>l.onToggle(c.value),handleSelect:()=>l.onSelect(c.value)}),(t,r)=>(V(),z(k(Ee),{"as-child":"",value:t.value,"allow-shift-key":""},{default:P(()=>[$(k(oe),de(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":g.value,"aria-expanded":p.value?i.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":g.value?"":void 0,"data-expanded":i.value?"":void 0,onKeydown:[G(W(a,["self","prevent"]),["enter","space"]),r[0]||(r[0]=G(W(d=>k(l).dir.value==="ltr"?T(d):y(d),["prevent"]),["right"])),r[1]||(r[1]=G(W(d=>k(l).dir.value==="ltr"?y(d):T(d),["prevent"]),["left"]))],onClick:r[2]||(r[2]=W(d=>{a(d),o(d)},["stop"]))}),{default:P(()=>[ue(t.$slots,"default",{isExpanded:i.value,isSelected:g.value,isIndeterminate:E.value,handleSelect:()=>k(l).onSelect(t.value),handleToggle:()=>k(l).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),Ne={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-highlighted before:bg-elevated"},false:{link:["hover:text-highlighted hover:before:bg-elevated/50","transition-colors before:transition-colors"]}}}},Ue=Object.assign({inheritAttrs:!1},{__name:"ProseCodeTree",props:{defaultValue:{type:String,required:!1},expandAll:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(s){const n=s,e=ye(),c=be(),[K,l]=ce(),f=B(()=>{var a,o;return se({extend:se(Ne),...((o=(a=c.uiPro)==null?void 0:a.prose)==null?void 0:o.codeTree)||{}})()}),p=O(n.defaultValue?{path:n.defaultValue}:void 0),i=O(),g=O(1),E=B(()=>{var a,o;return g.value,((o=(a=e.default)==null?void 0:a.call(e))==null?void 0:o.flatMap(I).filter(Boolean))||[]}),T=B(()=>y(E.value));function y(a){const o=new Map,t=[];a.forEach(d=>{const h=d.label.split("/");let v="";h.forEach((S,b)=>{var L,u;if(v=v?`${v}/${S}`:S,!o.has(v)){const m={label:S,path:v,...b<h.length-1&&{children:[]}};o.set(v,m),b===0?t.push(m):(u=(L=o.get(h.slice(0,b).join("/")))==null?void 0:L.children)==null||u.push(m)}})});const r=d=>d.sort((h,v)=>!!h.children==!!v.children?h.label.localeCompare(v.label):v.children?1:-1).map(h=>({...h,children:h.children&&r(h.children)}));return r(t)}function I(a,o){var t,r,d,h;return typeof a.type=="symbol"?(t=a.children)==null?void 0:t.map(I):{label:((r=a.props)==null?void 0:r.filename)||((d=a.props)==null?void 0:d.label)||`${o}`,icon:(h=a.props)==null?void 0:h.icon,component:a}}const R=B(()=>{var t;if(n.expandAll){const r=new Set;return E.value.forEach(d=>{const h=d.label.split("/");for(let v=1;v<h.length;v++)r.add(h.slice(0,v).join("/"))}),Array.from(r)}const a=(t=p.value)==null?void 0:t.path;if(!a)return[];const o=a.split("/");return o.map((r,d)=>o.slice(0,d+1).join("/"))});return xe(p,a=>{const o=E.value.find(t=>(a==null?void 0:a.path)===t.label);o!=null&&o.component&&(i.value=o)},{immediate:!0}),Ce(()=>g.value++),(a,o)=>{var t,r,d,h;return V(),N(ae,null,[$(k(K),null,{default:P(({items:v,level:S})=>[(V(!0),N(ae,null,ke(v,(b,L)=>{var u,m;return V(),N("li",{key:`${S}-${L}`,class:_(S>0?f.value.itemWithChildren({class:(u=n.ui)==null?void 0:u.itemWithChildren}):f.value.item({class:(m=n.ui)==null?void 0:m.item}))},[$(k(Oe),{"as-child":"",level:S,value:b},{default:P(({isExpanded:x,isSelected:A})=>{var C,w,M,D,F,j,Q,Z,J,X;return[q("button",{class:_(f.value.link({class:(C=n.ui)==null?void 0:C.link,active:A}))},[(w=b.children)!=null&&w.length?(V(),z(re,{key:0,name:x?k(c).ui.icons.folderOpen:k(c).ui.icons.folder,class:_(f.value.linkLeadingIcon({class:(M=n.ui)==null?void 0:M.linkLeadingIcon}))},null,8,["name","class"])):(V(),z(Se,{key:1,filename:b.label,class:_(f.value.linkLeadingIcon({class:(D=n.ui)==null?void 0:D.linkLeadingIcon}))},null,8,["filename","class"])),q("span",{class:_(f.value.linkLabel({class:(F=n.ui)==null?void 0:F.linkLabel}))},Ke(b.label),3),(j=b.children)!=null&&j.length?(V(),N("span",{key:2,class:_(f.value.linkTrailing({class:(Q=n.ui)==null?void 0:Q.linkTrailing}))},[$(re,{name:k(c).ui.icons.chevronDown,class:_(f.value.linkTrailingIcon({class:(Z=n.ui)==null?void 0:Z.linkTrailingIcon}))},null,8,["name","class"])],2)):ne("",!0)],2),(J=b.children)!=null&&J.length&&x?(V(),N("ul",{key:0,class:_(f.value.listWithChildren({class:(X=n.ui)==null?void 0:X.listWithChildren}))},[$(k(l),{items:b.children,level:S+1},null,8,["items","level"])],2)):ne("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),q("div",de(a.$attrs,{class:f.value.root({class:[(t=n.ui)==null?void 0:t.root,n.class]})}),[$(k(Me),{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=v=>p.value=v),class:_(f.value.list({class:(r=n.ui)==null?void 0:r.list})),items:T.value,"get-key":v=>v.path,"default-expanded":R.value},{default:P(()=>[$(k(l),{items:T.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),q("div",{class:_(f.value.content({class:(d=n.ui)==null?void 0:d.content}))},[(V(),z(Te((h=i.value)==null?void 0:h.component)))],2)],16)],64)}}});export{Ue as default};
